# Reading is good
## Tech Stack
+ java 11
+ embedded h2
+ spring boot 2.6.7
+ zalando problem
+ open api 3
+ docker
## API Documentation
API Documentation is generated by [springdoc openapi](https://springdoc.org/).  It is an alternative of springfox lib, it is not preferred because of [known issue](https://github.com/springfox/springfox/issues/3462) , [related with change in spring boot 2.6](https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.6-Release-Notes#pathpattern-based-path-matching-strategy-for-spring-mvc)
+ Please feel free to visit [PROJECT'S API DOCUMENTATION](http://localhost:8080/swagger-ui/index.html), (please run application)
+ You can also import the collection to Postman,
    + click import button
    + click Link tab
    + paste this: http://localhost:8080/v3/api-docs
    + click continue
    + click show advanced settings
    + folder organization : Tags
+One last note, you can also find postman_collection.json (collection v2.1) under the project's root page.
##  Security
Spring security framework works fine to secure endpoints. Every user can only has one authority. We have three types of authority :
+ ANONYMOUS -> can visit only permitAll pages
+ CUSTOMER (user1@getir.com/111111) -> can visit only customer related pages, like ordering book, listing books etc.
+ BO_USER (user2@getir.com/222222)-> can visit management and customer related pages, like creating book, listing orders...

>IMPORTANT!
> to log in, you need to call /v1/login/authentication endpoint with credentials.
> if you logged in successfully, endpoint will return a bearer token.
> you need to add that token as Authorization header with Bearer key
## Logging
Spring boot auto configured log4j infrastructure is preferred.
+ As an addition, we can log create/update events of entities like :
  2022-05-17 13:34:07.306  INFO 13420 --- [nio-8080-exec-1] c.g.r.listener.ModifiableEntityListener  : [AUDIT-SAVE][Order] created with id:1, by:user2@getir.com  
  2022-05-17 13:34:07.320  INFO 13420 --- [nio-8080-exec-1] c.g.r.listener.ModifiableEntityListener  : [AUDIT-UPDATE][Book] update with id:1, by:user2@getir.com
## How to
Note : because of the size issues adoptopenjdk/openjdk11 is preferred.

> >./mvnw package
>
> >docker build -t getir/reading-is-good-1.0.0 .
>
> >docker run -p 8080:8080 getir/reading-is-good-1.0.0
## Responses
- if endpoint you called works successfully then you get response related with endpoint, there is no base response defined.
- Some endpoints have bodyless response with code 201(CREATED)
- Some error response samples:

```json
{
  "title": "Unauthorized",
  "status": 401,
  "path": "/v1/stats/1",
  "localizedMessage": "Full authentication is required to access this resource"
}
```
```json
{
  "status": 400,
  "path": "/v1/backoffice/register",
  "localizedMessage": "E-mail address is already in use"
}
```
```json
{
  "status": 500,
  "path": "/v1/book",
  "localizedMessage": "A book with given ISBN is already defined."
}
```
```json
{
  "title": "Constraint Violation",
  "status": 400,
  "path": "/v1/backoffice/register",
  "violations": [
    {
      "field": "email",
      "message": "must be a well-formed email address"
    },
    {
      "field": "firstName",
      "message": "must not be null"
    },
    {
      "field": "password",
      "message": "length must be between 5 and 20"
    }
  ],
  "message": "One or more fields should be reviewed"
}
```